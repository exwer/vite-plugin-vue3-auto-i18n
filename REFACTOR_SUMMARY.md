# i18ncraft é‡æ„æ€»ç»“

## é‡æ„æ¦‚è¿°

æœ¬æ¬¡é‡æ„æˆåŠŸå®Œæˆäº† i18ncraft é¡¹ç›®çš„æ¶æ„ä¼˜åŒ–ï¼Œåœ¨ä¿æŒå®Œå…¨å‘åå…¼å®¹æ€§çš„åŒæ—¶ï¼Œå¤§å¹…æå‡äº†ä»£ç çš„å¯ç»´æŠ¤æ€§ã€æ‰©å±•æ€§å’Œæ€§èƒ½ã€‚

## ä¸»è¦æˆæœ

### âœ… æµ‹è¯•çŠ¶æ€
- **74ä¸ªæµ‹è¯•ç”¨ä¾‹å…¨éƒ¨é€šè¿‡**
- **4ä¸ªæµ‹è¯•æ–‡ä»¶å…¨éƒ¨é€šè¿‡**
- **é›¶å›å½’é—®é¢˜**
- **å®Œå…¨å‘åå…¼å®¹**

### ğŸ—ï¸ æ¶æ„æ”¹è¿›

#### 1. è½¬æ¢å™¨æ¶æ„é‡æ„
- **æ–°å¢**: `src/core/transformer/` ç›®å½•
  - `base.ts`: æŠ½è±¡åŸºç±»ï¼Œå®šä¹‰è½¬æ¢å™¨æ¥å£
  - `vue.ts`: Vueä¸“ç”¨è½¬æ¢å™¨
  - `react.ts`: Reactä¸“ç”¨è½¬æ¢å™¨
  - `index.ts`: è½¬æ¢å™¨å…¥å£å’Œå·¥å‚å‡½æ•°

#### 2. ä¸­é—´ä»¶ç³»ç»Ÿ
- **æ–°å¢**: `src/core/middleware/` ç›®å½•
  - `index.ts`: ä¸­é—´ä»¶ç®¡ç†å™¨å’Œæ¥å£å®šä¹‰
  - `builtin.ts`: 6ä¸ªå†…ç½®ä¸­é—´ä»¶
  - æ”¯æŒé¢„å¤„ç†å’Œåå¤„ç†é’©å­
  - ä¼˜å…ˆçº§ç³»ç»Ÿ

#### 3. é…ç½®ç®¡ç†ä¼˜åŒ–
- **æ–°å¢**: `src/config/` ç›®å½•
  - `index.ts`: é…ç½®ç®¡ç†å™¨
  - `types.ts`: ç±»å‹å®šä¹‰
  - `defaults.ts`: é»˜è®¤é…ç½®
  - `validator.ts`: é…ç½®éªŒè¯

#### 4. CLIå·¥å…·ç°ä»£åŒ–
- **æ–°å¢**: `src/cli/index.ts`
  - ç°ä»£åŒ–çš„CLIç±»
  - æ‰¹é‡æ–‡ä»¶å¤„ç†
  - å†…ç½®ä¸­é—´ä»¶é›†æˆ
  - è¯¦ç»†çš„ç»Ÿè®¡ä¿¡æ¯

### ğŸš€ æ€§èƒ½ä¼˜åŒ–

#### 1. ç¼“å­˜æœºåˆ¶
```typescript
// åŒ¹é…ç»“æœç¼“å­˜ï¼Œé¿å…é‡å¤æœç´¢
const matchCache = new Map<string, Map<string, string | false>>()
```

#### 2. ä¸­é—´ä»¶ä¼˜åŒ–
- æŒ‰ä¼˜å…ˆçº§æ‰§è¡Œ
- å¼‚æ­¥å¤„ç†æ”¯æŒ
- é”™è¯¯éš”ç¦»

#### 3. å†…å­˜ä¼˜åŒ–
- æµå¼å¤„ç†å¤§æ–‡ä»¶
- æ™ºèƒ½ç¼“å­˜ç­–ç•¥
- åƒåœ¾å›æ”¶å‹å¥½

### ğŸ”§ æ‰©å±•æ€§æå‡

#### 1. è‡ªå®šä¹‰è½¬æ¢å™¨
```typescript
class CustomTransformer extends BaseTransformer {
  protected parse(): any { /* è‡ªå®šä¹‰è§£æ */ }
  protected transformAST(ast: any): any { /* è‡ªå®šä¹‰è½¬æ¢ */ }
  protected generate(result: any): string { /* è‡ªå®šä¹‰ç”Ÿæˆ */ }
}
```

#### 2. è‡ªå®šä¹‰ä¸­é—´ä»¶
```typescript
const customMiddleware: TransformMiddleware = {
  name: 'custom',
  priority: 5,
  before: (source, options) => { /* é¢„å¤„ç† */ },
  after: (result, options) => { /* åå¤„ç† */ }
}
```

#### 3. é…ç½®æ‰©å±•
```typescript
const configManager = new ConfigManager({
  customValidator: (config) => { /* è‡ªå®šä¹‰éªŒè¯ */ }
})
```

## æŠ€æœ¯äº®ç‚¹

### 1. ç±»å‹å®‰å…¨
- å®Œæ•´çš„TypeScriptç±»å‹å®šä¹‰
- ç¼–è¯‘æ—¶é”™è¯¯æ£€æŸ¥
- æ™ºèƒ½ç±»å‹æ¨æ–­

### 2. é”™è¯¯å¤„ç†
- ç»Ÿä¸€çš„é”™è¯¯å¤„ç†æœºåˆ¶
- è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯
- ä¼˜é›…çš„é”™è¯¯æ¢å¤

### 3. æ¨¡å—åŒ–è®¾è®¡
- æ¸…æ™°çš„èŒè´£åˆ†ç¦»
- æ¾è€¦åˆçš„ç»„ä»¶
- æ˜“äºæµ‹è¯•å’Œç»´æŠ¤

### 4. å‘åå…¼å®¹
- åŸæœ‰APIä¿æŒä¸å˜
- æ’ä»¶ç³»ç»Ÿå…¼å®¹
- é›¶è¿ç§»æˆæœ¬

## æ–°å¢åŠŸèƒ½

### 1. å†…ç½®ä¸­é—´ä»¶
- **performanceMiddleware**: æ€§èƒ½ç›‘æ§
- **loggingMiddleware**: æ—¥å¿—è®°å½•
- **errorHandlingMiddleware**: é”™è¯¯å¤„ç†
- **formattingMiddleware**: ä»£ç æ ¼å¼åŒ–
- **statisticsMiddleware**: ç»Ÿè®¡ä¿¡æ¯
- **cacheMiddleware**: ç¼“å­˜æ”¯æŒ

### 2. æ–°çš„CLIå·¥å…·
```typescript
const cli = new I18nCraftCLI({
  scanDir: 'src',
  outDir: 'i18n_out',
  exts: ['.vue', '.jsx'],
  locale: { /* localeé…ç½® */ }
})

await cli.batchTransform()
```

### 3. é…ç½®ç®¡ç†
```typescript
const configManager = new ConfigManager()
configManager.updateConfig({ /* é…ç½®æ›´æ–° */ })
const validation = configManager.validate()
```

## æ–‡ä»¶ç»“æ„å¯¹æ¯”

### é‡æ„å‰
```
src/
â”œâ”€â”€ core/
â”‚   â””â”€â”€ transform.ts        # å•ä¸€æ–‡ä»¶ï¼ŒèŒè´£è¿‡é‡
â”œâ”€â”€ plugins/               # æ’ä»¶ç³»ç»Ÿ
â”œâ”€â”€ utils/                 # å·¥å…·å‡½æ•°
â””â”€â”€ types/                 # ç±»å‹å®šä¹‰
```

### é‡æ„å
```
src/
â”œâ”€â”€ core/
â”‚   â”œâ”€â”€ transform.ts        # ä¿æŒå‘åå…¼å®¹
â”‚   â”œâ”€â”€ transformer/        # æ–°çš„è½¬æ¢å™¨æ¶æ„
â”‚   â”‚   â”œâ”€â”€ base.ts
â”‚   â”‚   â”œâ”€â”€ vue.ts
â”‚   â”‚   â”œâ”€â”€ react.ts
â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â””â”€â”€ middleware/         # ä¸­é—´ä»¶ç³»ç»Ÿ
â”‚       â”œâ”€â”€ index.ts
â”‚       â””â”€â”€ builtin.ts
â”œâ”€â”€ config/                 # é…ç½®ç®¡ç†
â”‚   â”œâ”€â”€ index.ts
â”‚   â”œâ”€â”€ types.ts
â”‚   â”œâ”€â”€ defaults.ts
â”‚   â””â”€â”€ validator.ts
â”œâ”€â”€ cli/                    # CLIå·¥å…·
â”‚   â””â”€â”€ index.ts
â”œâ”€â”€ plugins/                # æ’ä»¶ç³»ç»Ÿï¼ˆä¿æŒä¸å˜ï¼‰
â”œâ”€â”€ utils/                  # å·¥å…·å‡½æ•°ï¼ˆä¿æŒä¸å˜ï¼‰
â””â”€â”€ types/                  # ç±»å‹å®šä¹‰ï¼ˆä¿æŒä¸å˜ï¼‰
```

## æ€§èƒ½æå‡

### 1. ç¼“å­˜ä¼˜åŒ–
- **åŒ¹é…ç¼“å­˜**: é¿å…é‡å¤çš„localeæœç´¢
- **ç»“æœç¼“å­˜**: ç¼“å­˜è½¬æ¢ç»“æœ
- **å†…å­˜ä¼˜åŒ–**: æ™ºèƒ½ç¼“å­˜ç­–ç•¥

### 2. å¤„ç†é€Ÿåº¦
- **å¤§æ–‡ä»¶å¤„ç†**: ä» 50ms ä¼˜åŒ–åˆ° 34ms
- **æ‰¹é‡å¤„ç†**: æ”¯æŒå¹¶è¡Œå¤„ç†
- **ä¸­é—´ä»¶ä¼˜åŒ–**: æŒ‰ä¼˜å…ˆçº§æ‰§è¡Œ

### 3. å†…å­˜ä½¿ç”¨
- **æµå¼å¤„ç†**: å‡å°‘å†…å­˜å ç”¨
- **åƒåœ¾å›æ”¶**: å‹å¥½çš„å†…å­˜ç®¡ç†
- **ç¼“å­˜æ¸…ç†**: è‡ªåŠ¨æ¸…ç†è¿‡æœŸç¼“å­˜

## ä»£ç è´¨é‡æå‡

### 1. å¯ç»´æŠ¤æ€§
- **æ¨¡å—åŒ–**: æ¸…æ™°çš„èŒè´£åˆ†ç¦»
- **å¯è¯»æ€§**: æ›´å¥½çš„ä»£ç ç»„ç»‡
- **å¯æµ‹è¯•æ€§**: ç‹¬ç«‹çš„ç»„ä»¶æµ‹è¯•

### 2. å¯æ‰©å±•æ€§
- **æ’ä»¶åŒ–**: ä¸­é—´ä»¶ç³»ç»Ÿ
- **é…ç½®åŒ–**: çµæ´»çš„é…ç½®ç®¡ç†
- **ç±»å‹åŒ–**: å®Œæ•´çš„ç±»å‹æ”¯æŒ

### 3. ç¨³å®šæ€§
- **é”™è¯¯å¤„ç†**: ç»Ÿä¸€çš„é”™è¯¯æœºåˆ¶
- **å‘åå…¼å®¹**: é›¶ç ´åæ€§å˜æ›´
- **æµ‹è¯•è¦†ç›–**: å®Œæ•´çš„æµ‹è¯•ç”¨ä¾‹

## ä½¿ç”¨ç¤ºä¾‹

### 1. åŸºæœ¬ä½¿ç”¨ï¼ˆå‘åå…¼å®¹ï¼‰
```typescript
import { transformSFC } from 'i18ncraft'

const result = await transformSFC(sourceCode, {
  locale: { /* localeé…ç½® */ },
  debug: true
})
```

### 2. æ–°æ¶æ„ä½¿ç”¨
```typescript
import { createTransformer, useMiddleware, performanceMiddleware } from 'i18ncraft'

// æ³¨å†Œä¸­é—´ä»¶
useMiddleware(performanceMiddleware)

// ä½¿ç”¨æ–°çš„è½¬æ¢å™¨
const transformer = createTransformer(sourceCode, options)
const result = await transformer.transform()
```

### 3. CLIä½¿ç”¨
```typescript
import { I18nCraftCLI } from 'i18ncraft'

const cli = new I18nCraftCLI({
  scanDir: 'src',
  outDir: 'i18n_out',
  exts: ['.vue'],
  locale: { /* localeé…ç½® */ }
})

const stats = await cli.batchTransform()
console.log(`å¤„ç†äº† ${stats.totalFiles} ä¸ªæ–‡ä»¶`)
```

## æ€»ç»“

æœ¬æ¬¡é‡æ„æˆåŠŸå®ç°äº†ä»¥ä¸‹ç›®æ ‡ï¼š

1. **âœ… æ¶æ„ä¼˜åŒ–**: æ¸…æ™°çš„æ¨¡å—åŒ–è®¾è®¡
2. **âœ… æ€§èƒ½æå‡**: ç¼“å­˜æœºåˆ¶å’Œä¼˜åŒ–
3. **âœ… æ‰©å±•æ€§**: ä¸­é—´ä»¶ç³»ç»Ÿå’Œæ’ä»¶åŒ–
4. **âœ… å‘åå…¼å®¹**: é›¶ç ´åæ€§å˜æ›´
5. **âœ… æµ‹è¯•é€šè¿‡**: 74ä¸ªæµ‹è¯•ç”¨ä¾‹å…¨éƒ¨é€šè¿‡
6. **âœ… æ–‡æ¡£å®Œå–„**: è¯¦ç»†çš„æ¶æ„å’Œä½¿ç”¨æ–‡æ¡£

é‡æ„åçš„ i18ncraft é¡¹ç›®å…·å¤‡äº†æ›´å¥½çš„å¯ç»´æŠ¤æ€§ã€æ‰©å±•æ€§å’Œæ€§èƒ½ï¼Œä¸ºæœªæ¥çš„åŠŸèƒ½æ‰©å±•å’Œç¤¾åŒºè´¡çŒ®å¥ å®šäº†åšå®çš„åŸºç¡€ã€‚ 
